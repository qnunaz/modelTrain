# センサーデータを用いた動き判別AIモデル (CNN-LSTM)

このプロジェクトは、ウェアラブルデバイスから取得される**加速度センサーとジャイロセンサーのデータ**を活用し、それが「静止している状態」なのか「動いている状態」なのかをAIが自動で判別するモデルを構築・学習するものです。

CNN(畳み込みニューラルネットワーク)とLSTM(再帰型ニューラルネットワーク)という2つの強力な深層学習技術を組み合わせることで、センサーデータの複雑なパターンや、時間とともに変化する「動き」のつながりを効果的に学習させます。

---

### プロセスの概要

本プログラムでは、以下の主要なプロセスを実行します。

1.  **センサーデータの読み込みと準備**:
    収集したセンサーデータを、AIが学習しやすい固定長のウィンドウ形式に整形し、前処理（例: 標準化）を行います。ファイルが存在しない場合は、デモンストレーション用にダミーデータを生成する機能も備えています。

2.  **1D/2D CNNによる特徴抽出**:
    センサーの時系列データから、動きの「サイン」となる重要な特徴を抽出します。通常一次元的なセンサーデータを2次元形式に変換するオプションも提供しており、これにより加速度とジャイロセンサーそれぞれの関係性や特徴量をより効率的に抽出することを目指します。

3.  **LSTMによる動きの流れの学習**:
    CNNで抽出された特徴を基に、LSTMが時系列データにおける「動きの連続性」を理解し、より文脈に基づいた賢い判別ができるように学習します。

4.  **データ拡張によるAIの強化**:
    少量のデータでも、ガウスノイズの注入によってデータ量を人工的に増やし、AIが多様な状況や未知のデータに対応できる汎化性能とロバスト性を向上させます。

5.  **学習と評価**:
    効率的なモデル学習のため、早期終了 (EarlyStopping) や学習率の自動調整 (ReduceLROnPlateau) などのコールバックを利用します。学習後は、精度、損失、分類レポート、混同行列といった詳細な指標でモデルの判別能力を評価します。

6.  **モデルの保存**:
    学習が完了し、最適な性能を発揮するAIモデルは、再利用可能なファイル形式（.h5）で保存されます。これにより、他のアプリケーションやシステムへの組み込みが容易になります。

---

### 学習スクリプト

モデルの構築と学習の詳細は、[`train.py`](train.py) ファイルで確認できます。

---

### 動作環境

* Python 3.x
* TensorFlow / Keras
* NumPy
* Pandas
* Scikit-learn
* Matplotlib
