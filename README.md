# センサーデータを用いた動き判別AIモデルとリアルタイムアプリケーション

このプロジェクトでは、ウェアラブルデバイスから取得される**加速度センサーとジャイロセンサーのデータ**を核に、AIが「静止している状態」と「動いている状態」を自動で判別するシステムを構築します。CNN（畳み込みニューラルネットワーク）とLSTM（再帰型ニューラルネットワーク）という深層学習技術を組み合わせることで、センサーデータの複雑なパターンや時間的な動きの連関を効果的に学習させます。

AIモデルの学習プロセスから、学習済みモデルを用いたリアルタイム判別アプリケーションまで、一貫したソリューションを提供します。これにより、デバイスの動きを視覚化しつつ、その状態をAIが即座に認識できるようになります。

---

## AIモデル学習プロセス

このセクションでは、AIモデルの構築と学習に焦点を当てます。

### プロセスの概要

モデル学習プログラムは、以下の主要なプロセスを実行します。

1.  **センサーデータの読み込みと準備**:
    収集したセンサーデータを、AIが学習しやすい固定長のウィンドウ形式に整形し、前処理（例: 標準化）を行います。
    
3.  **1D/2D CNNによる特徴抽出**:
    センサーの時系列データから、動きの「サイン」となる重要な特徴を抽出します。通常一次元的なセンサーデータを2次元形式に変換するオプションも提供しており、これにより加速度とジャイロセンサーそれぞれの関係性や特徴量をより効率的に抽出することを目指します。

4.  **LSTMによる動きの流れの学習**:
    CNNで抽出された特徴を基に、LSTMが時系列データにおける「動きの連続性」を理解し、より文脈に基づいた賢い判別ができるように学習します。

5.  **データ拡張によるAIの強化**:
    少量のデータでも、ガウスノイズの注入によってデータ量を人工的に増やし、AIが多様な状況や未知のデータに対応できる汎化性能とロバスト性を向上させます。

6.  **学習と評価**:
    効率的なモデル学習のため、早期終了 (EarlyStopping) や学習率の自動調整 (ReduceLROnPlateau) などのコールバックを利用します。学習後は、精度、損失、分類レポート、混同行列といった詳細な指標でモデルの判別能力を評価します。

7.  **モデルの保存**:
    学習が完了し、最適な性能を発揮するAIモデルは、再利用可能なファイル形式（.h5）で保存されます。これにより、他のアプリケーションやシステムへの組み込みが容易になります。

---

### 学習スクリプト

モデルの構築と学習の詳細は、[`train.py`](train.py) ファイルで確認できます。

---

### 動作環境（モデル学習用）

* Python 3.x
* TensorFlow / Keras
* NumPy
* Pandas
* Scikit-learn
* Matplotlib

---

## リアルタイムアプリケーション

このセクションでは、学習済みAIモデルを用いたリアルタイムアプリケーションについて説明します。

### 主要機能

リアルタイムアプリケーションは、以下の主要な機能を提供します。

1.  **リアルタイムデータ受信**:
    指定されたシリアルポート（COMポート）から、センサーデバイスの加速度計（X, Y, Z）とジャイロスコープ（X, Y, Z）のデータをリアルタイムで読み込みます。

2.  **3D加速度データ可視化**:
    受信した加速度センサーのデータを、Matplotlibを使った3Dグラフで動的に表示します。これにより、デバイスの動きを直感的に捉えられます。

3.  **ゼロクロス周波数計算**:
    加速度X軸データに対してゼロクロス周波数を計算し、振動の周期性を示す指標としてGUIに表示します。

4.  **リアルタイムAI動作判別**:
    事前に学習・保存された`CNN-LSTM`モデルとスケーラーを読み込み、受信したセンサーデータを使って「静止中」か「動作中」かをリアルタイムで判別します。判別結果とその確率もGUI上に表示されます。

5.  **Tkinter GUI**:
    センサーの生データ、判別結果、計算された周波数などを表示するためのシンプルなTkinterベースのグラフィカルユーザーインターフェースを提供します。

---

### 応用例：ゲームパッドとしての利用

このリアルタイム動作判別機能は、単なる監視にとどまらず、さまざまな応用が可能です。特に、**検出された「動作中」の状態をトリガーとして、各種アプリケーションの入力に利用できるゲームパッドとしての機能**です。

例えば、

* **仮想空間上の観光**: 身体動作を伴うことでより現実に近い体験を提供できます。
* **ゲーム**: シンプルなアクションゲームにおいて、物理的な動きがゲーム内の操作に直結する、より没入感のある体験を提供できます。
* **各種ソフトウェアの制御**: デバイスの動きによって特定のキー入力やマウス操作をエミュレートし、PC上の様々なアプリケーションをハンズフリーで操作することも可能です。

このように、本システムはセンサーデータを単に解析するだけでなく、実際のインタラクティブな用途への橋渡しとなる可能性を秘めています。

---

### 動作環境（リアルタイムアプリケーション用）

* Python 3.x
* Pyserial
* Matplotlib
* Numpy
* TensorFlow / Keras
* Scikit-learn / Joblib
* Tkinter

---

### リアルタイムアプリケーションの詳細

データの取得と処理プロセスの詳細は、[`detain.py`](detain.py) ファイルで確認できます。
